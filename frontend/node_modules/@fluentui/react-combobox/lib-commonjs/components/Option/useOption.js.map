{"version":3,"sources":["useOption.js"],"sourcesContent":["import * as React from 'react';\nimport { getNativeElementProps, resolveShorthand, useId, useMergedRefs } from '@fluentui/react-utilities';\nimport { useContextSelector } from '@fluentui/react-context-selector';\nimport { CheckmarkFilled, Checkmark12Filled } from '@fluentui/react-icons';\nimport { ComboboxContext } from '../../contexts/ComboboxContext';\nimport { ListboxContext } from '../../contexts/ListboxContext';\nfunction getTextString(text, children) {\n    if (text !== undefined) {\n        return text;\n    }\n    let textString = '';\n    let hasNonStringChild = false;\n    React.Children.forEach(children, (child)=>{\n        if (typeof child === 'string') {\n            textString += child;\n        } else {\n            hasNonStringChild = true;\n        }\n    });\n    // warn if an Option has non-string children and no text prop\n    if (hasNonStringChild) {\n        // eslint-disable-next-line no-console\n        console.warn('Provide a `text` prop to Option components when they contain non-string children.');\n    }\n    return textString;\n}\n/**\n * Create the state required to render Option.\n *\n * The returned state can be modified with hooks such as useOptionStyles_unstable,\n * before being passed to renderOption_unstable.\n *\n * @param props - props from this instance of Option\n * @param ref - reference to root HTMLElement of Option\n */ export const useOption_unstable = (props, ref)=>{\n    const { children , disabled , text , value  } = props;\n    const optionRef = React.useRef(null);\n    const optionText = getTextString(text, children);\n    const optionValue = value !== null && value !== void 0 ? value : optionText;\n    // use the id if provided, otherwise use a generated id\n    const id = useId('fluent-option', props.id);\n    // data used for context registration & events\n    const optionData = React.useMemo(()=>({\n            id,\n            disabled,\n            text: optionText,\n            value: optionValue\n        }), [\n        id,\n        disabled,\n        optionText,\n        optionValue\n    ]);\n    // context values\n    const focusVisible = useContextSelector(ListboxContext, (ctx)=>ctx.focusVisible);\n    const multiselect = useContextSelector(ListboxContext, (ctx)=>ctx.multiselect);\n    const registerOption = useContextSelector(ListboxContext, (ctx)=>ctx.registerOption);\n    const selected = useContextSelector(ListboxContext, (ctx)=>{\n        const selectedOptions = ctx.selectedOptions;\n        return !!optionValue && !!selectedOptions.find((o)=>o === optionValue);\n    });\n    const selectOption = useContextSelector(ListboxContext, (ctx)=>ctx.selectOption);\n    const setActiveOption = useContextSelector(ListboxContext, (ctx)=>ctx.setActiveOption);\n    const setOpen = useContextSelector(ComboboxContext, (ctx)=>ctx.setOpen);\n    // current active option?\n    const active = useContextSelector(ListboxContext, (ctx)=>{\n        var _ctx_activeOption, _ctx_activeOption1;\n        return ((_ctx_activeOption = ctx.activeOption) === null || _ctx_activeOption === void 0 ? void 0 : _ctx_activeOption.id) !== undefined && ((_ctx_activeOption1 = ctx.activeOption) === null || _ctx_activeOption1 === void 0 ? void 0 : _ctx_activeOption1.id) === id;\n    });\n    // check icon\n    let CheckIcon = /*#__PURE__*/ React.createElement(CheckmarkFilled, null);\n    if (multiselect) {\n        CheckIcon = selected ? /*#__PURE__*/ React.createElement(Checkmark12Filled, null) : '';\n    }\n    const onClick = (event)=>{\n        var _props_onClick;\n        if (disabled) {\n            event.preventDefault();\n            return;\n        }\n        // clicked option should always become active option\n        setActiveOption(optionData);\n        // close on option click for single-select options in a combobox\n        if (!multiselect) {\n            setOpen === null || setOpen === void 0 ? void 0 : setOpen(event, false);\n        }\n        // handle selection change\n        selectOption(event, optionData);\n        (_props_onClick = props.onClick) === null || _props_onClick === void 0 ? void 0 : _props_onClick.call(props, event);\n    };\n    // register option data with context\n    React.useEffect(()=>{\n        if (id && optionRef.current) {\n            return registerOption(optionData, optionRef.current);\n        }\n    }, [\n        id,\n        optionData,\n        registerOption\n    ]);\n    const semanticProps = multiselect ? {\n        role: 'menuitemcheckbox',\n        'aria-checked': selected\n    } : {\n        role: 'option',\n        'aria-selected': selected\n    };\n    return {\n        components: {\n            root: 'div',\n            checkIcon: 'span'\n        },\n        root: getNativeElementProps('div', {\n            ref: useMergedRefs(ref, optionRef),\n            'aria-disabled': disabled ? 'true' : undefined,\n            id,\n            ...semanticProps,\n            ...props,\n            onClick\n        }),\n        checkIcon: resolveShorthand(props.checkIcon, {\n            required: true,\n            defaultProps: {\n                'aria-hidden': 'true',\n                children: CheckIcon\n            }\n        }),\n        active,\n        disabled,\n        focusVisible,\n        multiselect,\n        selected\n    };\n};\n"],"names":["useOption_unstable","getTextString","text","children","undefined","textString","hasNonStringChild","React","Children","forEach","child","console","warn","props","ref","disabled","value","optionRef","useRef","optionText","optionValue","id","useId","optionData","useMemo","focusVisible","useContextSelector","ListboxContext","ctx","multiselect","registerOption","selected","selectedOptions","find","o","selectOption","setActiveOption","setOpen","ComboboxContext","active","_ctx_activeOption","_ctx_activeOption1","activeOption","CheckIcon","createElement","CheckmarkFilled","Checkmark12Filled","onClick","event","_props_onClick","preventDefault","call","useEffect","current","semanticProps","role","components","root","checkIcon","getNativeElementProps","useMergedRefs","resolveShorthand","required","defaultProps"],"mappings":"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"}