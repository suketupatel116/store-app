{"version":3,"sources":["useTooltip.js"],"sourcesContent":["import * as React from 'react';\nimport { mergeArrowOffset, resolvePositioningShorthand, usePositioning } from '@fluentui/react-positioning';\nimport { useTooltipVisibility_unstable as useTooltipVisibility, useFluent_unstable as useFluent } from '@fluentui/react-shared-contexts';\nimport { applyTriggerPropsToChildren, resolveShorthand, useControllableState, useId, useIsomorphicLayoutEffect, useIsSSR, useMergedRefs, useTimeout, getTriggerChild, mergeCallbacks, useEventCallback } from '@fluentui/react-utilities';\nimport { arrowHeight, tooltipBorderRadius } from './private/constants';\nimport { Escape } from '@fluentui/keyboard-keys';\n/**\n * Create the state required to render Tooltip.\n *\n * The returned state can be modified with hooks such as useTooltipStyles_unstable,\n * before being passed to renderTooltip_unstable.\n *\n * @param props - props from this instance of Tooltip\n */ export const useTooltip_unstable = (props)=>{\n    var _child_props, _child_props1, _child_props2, _child_props3;\n    const context = useTooltipVisibility();\n    const isServerSideRender = useIsSSR();\n    const { targetDocument  } = useFluent();\n    const [setDelayTimeout, clearDelayTimeout] = useTimeout();\n    const { appearance ='normal' , children , content , withArrow =false , positioning ='above' , onVisibleChange , relationship , showDelay =250 , hideDelay =250 , mountNode  } = props;\n    const [visible, setVisibleInternal] = useControllableState({\n        state: props.visible,\n        initialState: false\n    });\n    const setVisible = React.useCallback((newVisible, ev)=>{\n        clearDelayTimeout();\n        setVisibleInternal((oldVisible)=>{\n            if (newVisible !== oldVisible) {\n                onVisibleChange === null || onVisibleChange === void 0 ? void 0 : onVisibleChange(ev, {\n                    visible: newVisible\n                });\n            }\n            return newVisible;\n        });\n    }, [\n        clearDelayTimeout,\n        setVisibleInternal,\n        onVisibleChange\n    ]);\n    const state = {\n        withArrow,\n        positioning,\n        showDelay,\n        hideDelay,\n        relationship,\n        visible,\n        shouldRenderTooltip: visible,\n        appearance,\n        mountNode,\n        // Slots\n        components: {\n            content: 'div'\n        },\n        content: resolveShorthand(content, {\n            defaultProps: {\n                role: 'tooltip'\n            },\n            required: true\n        })\n    };\n    state.content.id = useId('tooltip-', state.content.id);\n    const positioningOptions = {\n        enabled: state.visible,\n        arrowPadding: 2 * tooltipBorderRadius,\n        position: 'above',\n        align: 'center',\n        offset: 4,\n        ...resolvePositioningShorthand(state.positioning)\n    };\n    if (state.withArrow) {\n        positioningOptions.offset = mergeArrowOffset(positioningOptions.offset, arrowHeight);\n    }\n    const { targetRef , containerRef , arrowRef  } = usePositioning(positioningOptions);\n    state.content.ref = useMergedRefs(state.content.ref, containerRef);\n    state.arrowRef = arrowRef;\n    // When this tooltip is visible, hide any other tooltips, and register it\n    // as the visibleTooltip with the TooltipContext.\n    // Also add a listener on document to hide the tooltip if Escape is pressed\n    useIsomorphicLayoutEffect(()=>{\n        if (visible) {\n            var _context_visibleTooltip;\n            const thisTooltip = {\n                hide: ()=>setVisible(false)\n            };\n            (_context_visibleTooltip = context.visibleTooltip) === null || _context_visibleTooltip === void 0 ? void 0 : _context_visibleTooltip.hide();\n            context.visibleTooltip = thisTooltip;\n            const onDocumentKeyDown = (ev)=>{\n                if (ev.key === Escape) {\n                    thisTooltip.hide();\n                    // stop propagation to avoid conflicting with other elements that listen for `Escape`\n                    // e,g: Dialog, Popover, Menu\n                    ev.stopPropagation();\n                }\n            };\n            targetDocument === null || targetDocument === void 0 ? void 0 : targetDocument.addEventListener('keydown', onDocumentKeyDown, {\n                // As this event is added at targeted document,\n                // we need to capture the event to be sure keydown handling from tooltip happens first\n                capture: true\n            });\n            return ()=>{\n                if (context.visibleTooltip === thisTooltip) {\n                    context.visibleTooltip = undefined;\n                }\n                targetDocument === null || targetDocument === void 0 ? void 0 : targetDocument.removeEventListener('keydown', onDocumentKeyDown, {\n                    capture: true\n                });\n            };\n        }\n    }, [\n        context,\n        targetDocument,\n        visible,\n        setVisible\n    ]);\n    // The focused element gets a blur event when the document loses focus\n    // (e.g. switching tabs in the browser), but we don't want to show the\n    // tooltip again when the document gets focus back. Handle this case by\n    // checking if the blurred element is still the document's activeElement.\n    // See https://github.com/microsoft/fluentui/issues/13541\n    const ignoreNextFocusEventRef = React.useRef(false);\n    // Listener for onPointerEnter and onFocus on the trigger element\n    const onEnterTrigger = React.useCallback((ev)=>{\n        if (ev.type === 'focus' && ignoreNextFocusEventRef.current) {\n            ignoreNextFocusEventRef.current = false;\n            return;\n        }\n        // Show immediately if another tooltip is already visible\n        const delay = context.visibleTooltip ? 0 : state.showDelay;\n        setDelayTimeout(()=>{\n            setVisible(true, ev);\n        }, delay);\n        ev.persist(); // Persist the event since the setVisible call will happen asynchronously\n    }, [\n        setDelayTimeout,\n        setVisible,\n        state.showDelay,\n        context\n    ]);\n    // Listener for onPointerLeave and onBlur on the trigger element\n    const onLeaveTrigger = React.useCallback((ev)=>{\n        let delay = state.hideDelay;\n        if (ev.type === 'blur') {\n            // Hide immediately when losing focus\n            delay = 0;\n            ignoreNextFocusEventRef.current = (targetDocument === null || targetDocument === void 0 ? void 0 : targetDocument.activeElement) === ev.target;\n        }\n        setDelayTimeout(()=>{\n            setVisible(false, ev);\n        }, delay);\n        ev.persist(); // Persist the event since the setVisible call will happen asynchronously\n    }, [\n        setDelayTimeout,\n        setVisible,\n        state.hideDelay,\n        targetDocument\n    ]);\n    // Cancel the hide timer when the mouse or focus enters the tooltip, and restart it when the mouse or focus leaves.\n    // This keeps the tooltip visible when the mouse is moved over it, or it has focus within.\n    state.content.onPointerEnter = mergeCallbacks(state.content.onPointerEnter, clearDelayTimeout);\n    state.content.onPointerLeave = mergeCallbacks(state.content.onPointerLeave, onLeaveTrigger);\n    state.content.onFocus = mergeCallbacks(state.content.onFocus, clearDelayTimeout);\n    state.content.onBlur = mergeCallbacks(state.content.onBlur, onLeaveTrigger);\n    const child = getTriggerChild(children);\n    const triggerAriaProps = {};\n    if (relationship === 'label') {\n        // aria-label only works if the content is a string. Otherwise, need to use aria-labelledby.\n        if (typeof state.content.children === 'string') {\n            triggerAriaProps['aria-label'] = state.content.children;\n        } else {\n            triggerAriaProps['aria-labelledby'] = state.content.id;\n            // Always render the tooltip even if hidden, so that aria-labelledby refers to a valid element\n            state.shouldRenderTooltip = true;\n        }\n    } else if (relationship === 'description') {\n        triggerAriaProps['aria-describedby'] = state.content.id;\n        // Always render the tooltip even if hidden, so that aria-describedby refers to a valid element\n        state.shouldRenderTooltip = true;\n    }\n    // Don't render the Tooltip in SSR to avoid hydration errors\n    if (isServerSideRender) {\n        state.shouldRenderTooltip = false;\n    }\n    const childTargetRef = useMergedRefs(child === null || child === void 0 ? void 0 : child.ref, targetRef);\n    // Apply the trigger props to the child, either by calling the render function, or cloning with the new props\n    state.children = applyTriggerPropsToChildren(children, {\n        ...triggerAriaProps,\n        ...child === null || child === void 0 ? void 0 : child.props,\n        // If the target prop is not provided, attach targetRef to the trigger element's ref prop\n        ref: positioningOptions.target === undefined ? childTargetRef : child === null || child === void 0 ? void 0 : child.ref,\n        onPointerEnter: useEventCallback(mergeCallbacks(child === null || child === void 0 ? void 0 : (_child_props = child.props) === null || _child_props === void 0 ? void 0 : _child_props.onPointerEnter, onEnterTrigger)),\n        onPointerLeave: useEventCallback(mergeCallbacks(child === null || child === void 0 ? void 0 : (_child_props1 = child.props) === null || _child_props1 === void 0 ? void 0 : _child_props1.onPointerLeave, onLeaveTrigger)),\n        onFocus: useEventCallback(mergeCallbacks(child === null || child === void 0 ? void 0 : (_child_props2 = child.props) === null || _child_props2 === void 0 ? void 0 : _child_props2.onFocus, onEnterTrigger)),\n        onBlur: useEventCallback(mergeCallbacks(child === null || child === void 0 ? void 0 : (_child_props3 = child.props) === null || _child_props3 === void 0 ? void 0 : _child_props3.onBlur, onLeaveTrigger))\n    });\n    return state;\n};\n"],"names":["useTooltip_unstable","props","_child_props","_child_props1","_child_props2","_child_props3","context","useTooltipVisibility","isServerSideRender","useIsSSR","targetDocument","useFluent","setDelayTimeout","clearDelayTimeout","useTimeout","appearance","children","content","withArrow","positioning","onVisibleChange","relationship","showDelay","hideDelay","mountNode","visible","setVisibleInternal","useControllableState","state","initialState","setVisible","React","useCallback","newVisible","ev","oldVisible","shouldRenderTooltip","components","resolveShorthand","defaultProps","role","required","id","useId","positioningOptions","enabled","arrowPadding","tooltipBorderRadius","position","align","offset","resolvePositioningShorthand","mergeArrowOffset","arrowHeight","targetRef","containerRef","arrowRef","usePositioning","ref","useMergedRefs","useIsomorphicLayoutEffect","_context_visibleTooltip","thisTooltip","hide","visibleTooltip","onDocumentKeyDown","key","Escape","stopPropagation","addEventListener","capture","undefined","removeEventListener","ignoreNextFocusEventRef","useRef","onEnterTrigger","type","current","delay","persist","onLeaveTrigger","activeElement","target","onPointerEnter","mergeCallbacks","onPointerLeave","onFocus","onBlur","child","getTriggerChild","triggerAriaProps","childTargetRef","applyTriggerPropsToChildren","useEventCallback"],"mappings":"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"}