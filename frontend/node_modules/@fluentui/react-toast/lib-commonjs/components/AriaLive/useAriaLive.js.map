{"version":3,"sources":["useAriaLive.js"],"sourcesContent":["import * as React from 'react';\nimport { resolveShorthand, createPriorityQueue, useEventCallback } from '@fluentui/react-utilities';\n/** The duration the message needs to be in present in DOM for screen readers to register a change and announce */ const MESSAGE_DURATION = 500;\n/**\n * Create the state required to render AriaLive.\n *\n * The returned state can be modified with hooks such as useAriaLiveStyles_unstable,\n * before being passed to renderAriaLive_unstable.\n *\n * @param props - props from this instance of AriaLive\n */ export const useAriaLive_unstable = (props)=>{\n    const [currentMessage, setCurrentMessage] = React.useState(undefined);\n    // Can't rely on Date.now() if user invokes announce more than once in a code block\n    const order = React.useRef(0);\n    const [messageQueue] = React.useState(()=>createPriorityQueue((a, b)=>{\n            if (a.politeness === b.politeness) {\n                return a.createdAt - b.createdAt;\n            }\n            return a.politeness === 'assertive' ? -1 : 1;\n        }));\n    const announce = useEventCallback((message, options)=>{\n        const { politeness  } = options;\n        if (message === (currentMessage === null || currentMessage === void 0 ? void 0 : currentMessage.message)) {\n            return;\n        }\n        const liveMessage = {\n            message,\n            politeness,\n            createdAt: order.current++\n        };\n        if (!currentMessage) {\n            setCurrentMessage(liveMessage);\n        } else {\n            messageQueue.enqueue(liveMessage);\n        }\n    });\n    React.useEffect(()=>{\n        const timeout = setTimeout(()=>{\n            if (messageQueue.peek()) {\n                setCurrentMessage(messageQueue.dequeue());\n            } else {\n                setCurrentMessage(undefined);\n            }\n        }, MESSAGE_DURATION);\n        return ()=>clearTimeout(timeout);\n    }, [\n        currentMessage,\n        messageQueue\n    ]);\n    React.useImperativeHandle(props.announceRef, ()=>announce);\n    const politeMessage = (currentMessage === null || currentMessage === void 0 ? void 0 : currentMessage.politeness) === 'polite' ? currentMessage.message : undefined;\n    const assertiveMessage = (currentMessage === null || currentMessage === void 0 ? void 0 : currentMessage.politeness) === 'assertive' ? currentMessage.message : undefined;\n    return {\n        components: {\n            assertive: 'div',\n            polite: 'div'\n        },\n        assertive: resolveShorthand(props.assertive, {\n            required: true,\n            defaultProps: {\n                'aria-live': 'assertive',\n                children: assertiveMessage\n            }\n        }),\n        polite: resolveShorthand(props.polite, {\n            required: true,\n            defaultProps: {\n                'aria-live': 'polite',\n                children: politeMessage\n            }\n        })\n    };\n};\n"],"names":["useAriaLive_unstable","MESSAGE_DURATION","props","currentMessage","setCurrentMessage","React","useState","undefined","order","useRef","messageQueue","createPriorityQueue","a","b","politeness","createdAt","announce","useEventCallback","message","options","liveMessage","current","enqueue","useEffect","timeout","setTimeout","peek","dequeue","clearTimeout","useImperativeHandle","announceRef","politeMessage","assertiveMessage","components","assertive","polite","resolveShorthand","required","defaultProps","children"],"mappings":";;;;+BAUiBA;;aAAAA;;;6DAVM;gCACiD;AACxE,gHAAgH,GAAG,MAAMC,mBAAmB;AAQjI,MAAMD,uBAAuB,CAACE,QAAQ;IAC7C,MAAM,CAACC,gBAAgBC,kBAAkB,GAAGC,OAAMC,QAAQ,CAACC;IAC3D,mFAAmF;IACnF,MAAMC,QAAQH,OAAMI,MAAM,CAAC;IAC3B,MAAM,CAACC,aAAa,GAAGL,OAAMC,QAAQ,CAAC,IAAIK,IAAAA,mCAAmB,EAAC,CAACC,GAAGC,IAAI;YAC9D,IAAID,EAAEE,UAAU,KAAKD,EAAEC,UAAU,EAAE;gBAC/B,OAAOF,EAAEG,SAAS,GAAGF,EAAEE,SAAS;YACpC,CAAC;YACD,OAAOH,EAAEE,UAAU,KAAK,cAAc,CAAC,IAAI,CAAC;QAChD;IACJ,MAAME,WAAWC,IAAAA,gCAAgB,EAAC,CAACC,SAASC,UAAU;QAClD,MAAM,EAAEL,WAAU,EAAG,GAAGK;QACxB,IAAID,YAAaf,CAAAA,mBAAmB,IAAI,IAAIA,mBAAmB,KAAK,IAAI,KAAK,IAAIA,eAAee,OAAO,AAAD,GAAI;YACtG;QACJ,CAAC;QACD,MAAME,cAAc;YAChBF;YACAJ;YACAC,WAAWP,MAAMa,OAAO;QAC5B;QACA,IAAI,CAAClB,gBAAgB;YACjBC,kBAAkBgB;QACtB,OAAO;YACHV,aAAaY,OAAO,CAACF;QACzB,CAAC;IACL;IACAf,OAAMkB,SAAS,CAAC,IAAI;QAChB,MAAMC,UAAUC,WAAW,IAAI;YAC3B,IAAIf,aAAagB,IAAI,IAAI;gBACrBtB,kBAAkBM,aAAaiB,OAAO;YAC1C,OAAO;gBACHvB,kBAAkBG;YACtB,CAAC;QACL,GAAGN;QACH,OAAO,IAAI2B,aAAaJ;IAC5B,GAAG;QACCrB;QACAO;KACH;IACDL,OAAMwB,mBAAmB,CAAC3B,MAAM4B,WAAW,EAAE,IAAId;IACjD,MAAMe,gBAAgB,AAAC5B,CAAAA,mBAAmB,IAAI,IAAIA,mBAAmB,KAAK,IAAI,KAAK,IAAIA,eAAeW,UAAU,AAAD,MAAO,WAAWX,eAAee,OAAO,GAAGX,SAAS;IACnK,MAAMyB,mBAAmB,AAAC7B,CAAAA,mBAAmB,IAAI,IAAIA,mBAAmB,KAAK,IAAI,KAAK,IAAIA,eAAeW,UAAU,AAAD,MAAO,cAAcX,eAAee,OAAO,GAAGX,SAAS;IACzK,OAAO;QACH0B,YAAY;YACRC,WAAW;YACXC,QAAQ;QACZ;QACAD,WAAWE,IAAAA,gCAAgB,EAAClC,MAAMgC,SAAS,EAAE;YACzCG,UAAU,IAAI;YACdC,cAAc;gBACV,aAAa;gBACbC,UAAUP;YACd;QACJ;QACAG,QAAQC,IAAAA,gCAAgB,EAAClC,MAAMiC,MAAM,EAAE;YACnCE,UAAU,IAAI;YACdC,cAAc;gBACV,aAAa;gBACbC,UAAUR;YACd;QACJ;IACJ;AACJ"}