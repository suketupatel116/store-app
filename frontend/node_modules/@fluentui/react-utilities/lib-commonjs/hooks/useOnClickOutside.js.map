{"version":3,"sources":["useOnClickOutside.js"],"sourcesContent":["import * as React from 'react';\nimport { useEventCallback } from './useEventCallback';\n/**\n * @internal\n * Utility to perform checks where a click/touch event was made outside a component\n */ export const useOnClickOutside = (options)=>{\n    const { refs , callback , element , disabled , contains: containsProp  } = options;\n    const timeoutId = React.useRef(undefined);\n    useIFrameFocus(options);\n    const listener = useEventCallback((ev)=>{\n        const contains = containsProp || ((parent, child)=>{\n            return !!(parent === null || parent === void 0 ? void 0 : parent.contains(child));\n        });\n        const target = ev.composedPath()[0];\n        const isOutside = refs.every((ref)=>!contains(ref.current || null, target));\n        if (isOutside && !disabled) {\n            callback(ev);\n        }\n    });\n    React.useEffect(()=>{\n        if (disabled) {\n            return;\n        }\n        // Store the current event to avoid triggering handlers immediately\n        // Note this depends on a deprecated but extremely well supported quirk of the web platform\n        // https://github.com/facebook/react/issues/20074\n        let currentEvent = getWindowEvent(window);\n        const conditionalHandler = (event)=>{\n            // Skip if this event is the same as the one running when we added the handlers\n            if (event === currentEvent) {\n                currentEvent = undefined;\n                return;\n            }\n            listener(event);\n        };\n        // use capture phase because React can update DOM before the event bubbles to the document\n        element === null || element === void 0 ? void 0 : element.addEventListener('click', conditionalHandler, true);\n        element === null || element === void 0 ? void 0 : element.addEventListener('touchstart', conditionalHandler, true);\n        element === null || element === void 0 ? void 0 : element.addEventListener('contextmenu', conditionalHandler, true);\n        // Garbage collect this event after it's no longer useful to avoid memory leaks\n        timeoutId.current = window.setTimeout(()=>{\n            currentEvent = undefined;\n        }, 1);\n        return ()=>{\n            element === null || element === void 0 ? void 0 : element.removeEventListener('click', conditionalHandler, true);\n            element === null || element === void 0 ? void 0 : element.removeEventListener('touchstart', conditionalHandler, true);\n            element === null || element === void 0 ? void 0 : element.removeEventListener('contextmenu', conditionalHandler, true);\n            clearTimeout(timeoutId.current);\n            currentEvent = undefined;\n        };\n    }, [\n        listener,\n        element,\n        disabled\n    ]);\n};\nconst getWindowEvent = (target)=>{\n    if (target) {\n        var _target_ownerDocument, _target_ownerDocument_defaultView;\n        if (typeof target.window === 'object' && target.window === target) {\n            // eslint-disable-next-line deprecation/deprecation\n            return target.event;\n        }\n        var _target_ownerDocument_defaultView_event;\n        // eslint-disable-next-line deprecation/deprecation\n        return (_target_ownerDocument_defaultView_event = (_target_ownerDocument = target.ownerDocument) === null || _target_ownerDocument === void 0 ? void 0 : (_target_ownerDocument_defaultView = _target_ownerDocument.defaultView) === null || _target_ownerDocument_defaultView === void 0 ? void 0 : _target_ownerDocument_defaultView.event) !== null && _target_ownerDocument_defaultView_event !== void 0 ? _target_ownerDocument_defaultView_event : undefined;\n    }\n    return undefined;\n};\nconst FUI_FRAME_EVENT = 'fuiframefocus';\n/**\n * Since click events do not propagate past iframes, we use focus to detect if a\n * click has happened inside an iframe, since the only ways of focusing inside an\n * iframe are:\n *   - clicking inside\n *   - tabbing inside\n *\n * Polls the value of `document.activeElement`. If it is an iframe, then dispatch\n * a custom DOM event. When the custom event is received call the provided callback\n */ const useIFrameFocus = (options)=>{\n    const { disabled , element: targetDocument , callback , contains: containsProp = (parent, child)=>{\n        return !!(parent === null || parent === void 0 ? void 0 : parent.contains(child));\n    } , pollDuration =1000 , refs  } = options;\n    const timeoutRef = React.useRef();\n    const listener = useEventCallback((e)=>{\n        const contains = containsProp || ((parent, child)=>{\n            return !!(parent === null || parent === void 0 ? void 0 : parent.contains(child));\n        });\n        const isOutside = refs.every((ref)=>!contains(ref.current || null, e.target));\n        if (isOutside && !disabled) {\n            callback(e);\n        }\n    });\n    // Adds listener to the custom iframe focus event\n    React.useEffect(()=>{\n        if (disabled) {\n            return;\n        }\n        targetDocument === null || targetDocument === void 0 ? void 0 : targetDocument.addEventListener(FUI_FRAME_EVENT, listener, true);\n        return ()=>{\n            targetDocument === null || targetDocument === void 0 ? void 0 : targetDocument.removeEventListener(FUI_FRAME_EVENT, listener, true);\n        };\n    }, [\n        targetDocument,\n        disabled,\n        listener\n    ]);\n    // Starts polling for the active element\n    React.useEffect(()=>{\n        var _targetDocument_defaultView;\n        if (disabled) {\n            return;\n        }\n        timeoutRef.current = targetDocument === null || targetDocument === void 0 ? void 0 : (_targetDocument_defaultView = targetDocument.defaultView) === null || _targetDocument_defaultView === void 0 ? void 0 : _targetDocument_defaultView.setInterval(()=>{\n            const activeElement = targetDocument === null || targetDocument === void 0 ? void 0 : targetDocument.activeElement;\n            if ((activeElement === null || activeElement === void 0 ? void 0 : activeElement.tagName) === 'IFRAME' || (activeElement === null || activeElement === void 0 ? void 0 : activeElement.tagName) === 'WEBVIEW') {\n                const event = new CustomEvent(FUI_FRAME_EVENT, {\n                    bubbles: true\n                });\n                activeElement.dispatchEvent(event);\n            }\n        }, pollDuration);\n        return ()=>{\n            var _targetDocument_defaultView;\n            targetDocument === null || targetDocument === void 0 ? void 0 : (_targetDocument_defaultView = targetDocument.defaultView) === null || _targetDocument_defaultView === void 0 ? void 0 : _targetDocument_defaultView.clearTimeout(timeoutRef.current);\n        };\n    }, [\n        targetDocument,\n        disabled,\n        pollDuration\n    ]);\n};\n"],"names":["useOnClickOutside","options","refs","callback","element","disabled","contains","containsProp","timeoutId","React","useRef","undefined","useIFrameFocus","listener","useEventCallback","ev","parent","child","target","composedPath","isOutside","every","ref","current","useEffect","currentEvent","getWindowEvent","window","conditionalHandler","event","addEventListener","setTimeout","removeEventListener","clearTimeout","_target_ownerDocument","_target_ownerDocument_defaultView","_target_ownerDocument_defaultView_event","ownerDocument","defaultView","FUI_FRAME_EVENT","targetDocument","pollDuration","timeoutRef","e","_targetDocument_defaultView","setInterval","activeElement","tagName","CustomEvent","bubbles","dispatchEvent"],"mappings":"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"}