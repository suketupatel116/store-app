{"version":3,"sources":["useSelection.ts"],"sourcesContent":["import * as React from 'react';\nimport { SelectionHookParams, SelectionItemId, SelectionMethods } from './types';\nimport { useControllableState } from '../hooks/useControllableState';\nimport { createSetFromIterable } from '../utils/createSetFromIterable';\n\nfunction useSelectionState(params: Omit<SelectionHookParams, 'selectionMode'>) {\n  const [selected, setSelected] = useControllableState<Set<SelectionItemId>>({\n    initialState: new Set(),\n    defaultState: React.useMemo(\n      () => params.defaultSelectedItems && createSetFromIterable(params.defaultSelectedItems),\n      [params.defaultSelectedItems],\n    ),\n    state: React.useMemo(\n      () => params.selectedItems && createSetFromIterable(params.selectedItems),\n      [params.selectedItems],\n    ),\n  });\n  const changeSelection = (event: React.SyntheticEvent, nextSelectedItems: Set<SelectionItemId>) => {\n    params.onSelectionChange?.(event, { selectedItems: nextSelectedItems });\n    setSelected(nextSelectedItems);\n  };\n  return [selected, changeSelection] as const;\n}\n\nfunction useSingleSelection(params: Omit<SelectionHookParams, 'selectionMode'>) {\n  const [selected, changeSelection] = useSelectionState(params);\n  const methods: SelectionMethods = {\n    deselectItem: event => changeSelection(event, new Set()),\n    selectItem: (event, itemId) => changeSelection(event, new Set([itemId])),\n    toggleAllItems: () => {\n      if (process.env.NODE_ENV !== 'production') {\n        throw new Error('[react-utilities]: `toggleAllItems` should not be used in single selection mode');\n      }\n    },\n    toggleItem: (event, itemId) => changeSelection(event, new Set([itemId])),\n    clearItems: event => changeSelection(event, new Set()),\n    isSelected: itemId => selected.has(itemId) ?? false,\n  };\n  return [selected, methods] as const;\n}\n\nfunction useMultipleSelection(params: Omit<SelectionHookParams, 'selectionMode'>) {\n  const [selected, changeSelection] = useSelectionState(params);\n  const methods: SelectionMethods = {\n    toggleItem: (event, itemId) => {\n      const nextSelectedItems = new Set(selected);\n      if (selected.has(itemId)) {\n        nextSelectedItems.delete(itemId);\n      } else {\n        nextSelectedItems.add(itemId);\n      }\n      changeSelection(event, nextSelectedItems);\n    },\n    selectItem: (event, itemId) => {\n      const nextSelectedItems = new Set(selected);\n      nextSelectedItems.add(itemId);\n      changeSelection(event, nextSelectedItems);\n    },\n    deselectItem: (event, itemId) => {\n      const nextSelectedItems = new Set(selected);\n      nextSelectedItems.delete(itemId);\n      changeSelection(event, nextSelectedItems);\n    },\n    clearItems: event => {\n      changeSelection(event, new Set());\n    },\n    isSelected: itemId => selected.has(itemId),\n    toggleAllItems: (event, itemIds) => {\n      const allItemsSelected = itemIds.every(itemId => selected.has(itemId));\n      const nextSelectedItems = new Set(selected);\n      if (allItemsSelected) {\n        nextSelectedItems.clear();\n      } else {\n        itemIds.forEach(itemId => nextSelectedItems.add(itemId));\n      }\n      changeSelection(event, nextSelectedItems);\n    },\n  };\n  return [selected, methods] as const;\n}\n\nexport function useSelection(params: SelectionHookParams) {\n  if (params.selectionMode === 'multiselect') {\n    // selectionMode is a static value, so we can safely ignore rules-of-hooks\n    // eslint-disable-next-line react-hooks/rules-of-hooks\n    return useMultipleSelection(params);\n  }\n  // selectionMode is a static value, so we can safely ignore rules-of-hooks\n  // eslint-disable-next-line react-hooks/rules-of-hooks\n  return useSingleSelection(params);\n}\n"],"names":["React","useControllableState","createSetFromIterable","useSelectionState","params","selected","setSelected","initialState","Set","defaultState","useMemo","defaultSelectedItems","state","selectedItems","changeSelection","event","nextSelectedItems","onSelectionChange","useSingleSelection","methods","deselectItem","selectItem","itemId","toggleAllItems","process","env","NODE_ENV","Error","toggleItem","clearItems","isSelected","has","useMultipleSelection","delete","add","itemIds","allItemsSelected","every","clear","forEach","useSelection","selectionMode"],"mappings":"AAAA,YAAYA,WAAW,QAAQ;AAE/B,SAASC,oBAAoB,QAAQ,gCAAgC;AACrE,SAASC,qBAAqB,QAAQ,iCAAiC;AAEvE,SAASC,kBAAkBC,MAAkD,EAAE;IAC7E,MAAM,CAACC,UAAUC,YAAY,GAAGL,qBAA2C;QACzEM,cAAc,IAAIC;QAClBC,cAAcT,MAAMU,OAAO,CACzB,IAAMN,OAAOO,oBAAoB,IAAIT,sBAAsBE,OAAOO,oBAAoB,GACtF;YAACP,OAAOO,oBAAoB;SAAC;QAE/BC,OAAOZ,MAAMU,OAAO,CAClB,IAAMN,OAAOS,aAAa,IAAIX,sBAAsBE,OAAOS,aAAa,GACxE;YAACT,OAAOS,aAAa;SAAC;IAE1B;IACA,MAAMC,kBAAkB,CAACC,OAA6BC,oBAA4C;YAChGZ;QAAAA,CAAAA,4BAAAA,OAAOa,iBAAiB,cAAxBb,uCAAAA,KAAAA,IAAAA,0BAAAA,KAAAA,QAA2BW,OAAO;YAAEF,eAAeG;QAAkB;QACrEV,YAAYU;IACd;IACA,OAAO;QAACX;QAAUS;KAAgB;AACpC;AAEA,SAASI,mBAAmBd,MAAkD,EAAE;IAC9E,MAAM,CAACC,UAAUS,gBAAgB,GAAGX,kBAAkBC;QAW9BC;IAVxB,MAAMc,UAA4B;QAChCC,cAAcL,CAAAA,QAASD,gBAAgBC,OAAO,IAAIP;QAClDa,YAAY,CAACN,OAAOO,SAAWR,gBAAgBC,OAAO,IAAIP,IAAI;gBAACc;aAAO;QACtEC,gBAAgB,IAAM;YACpB,IAAIC,QAAQC,GAAG,CAACC,QAAQ,KAAK,cAAc;gBACzC,MAAM,IAAIC,MAAM,mFAAmF;YACrG,CAAC;QACH;QACAC,YAAY,CAACb,OAAOO,SAAWR,gBAAgBC,OAAO,IAAIP,IAAI;gBAACc;aAAO;QACtEO,YAAYd,CAAAA,QAASD,gBAAgBC,OAAO,IAAIP;QAChDsB,YAAYR,CAAAA,SAAUjB,CAAAA,gBAAAA,SAAS0B,GAAG,CAACT,qBAAbjB,2BAAAA,gBAAwB,KAAK;IACrD;IACA,OAAO;QAACA;QAAUc;KAAQ;AAC5B;AAEA,SAASa,qBAAqB5B,MAAkD,EAAE;IAChF,MAAM,CAACC,UAAUS,gBAAgB,GAAGX,kBAAkBC;IACtD,MAAMe,UAA4B;QAChCS,YAAY,CAACb,OAAOO,SAAW;YAC7B,MAAMN,oBAAoB,IAAIR,IAAIH;YAClC,IAAIA,SAAS0B,GAAG,CAACT,SAAS;gBACxBN,kBAAkBiB,MAAM,CAACX;YAC3B,OAAO;gBACLN,kBAAkBkB,GAAG,CAACZ;YACxB,CAAC;YACDR,gBAAgBC,OAAOC;QACzB;QACAK,YAAY,CAACN,OAAOO,SAAW;YAC7B,MAAMN,oBAAoB,IAAIR,IAAIH;YAClCW,kBAAkBkB,GAAG,CAACZ;YACtBR,gBAAgBC,OAAOC;QACzB;QACAI,cAAc,CAACL,OAAOO,SAAW;YAC/B,MAAMN,oBAAoB,IAAIR,IAAIH;YAClCW,kBAAkBiB,MAAM,CAACX;YACzBR,gBAAgBC,OAAOC;QACzB;QACAa,YAAYd,CAAAA,QAAS;YACnBD,gBAAgBC,OAAO,IAAIP;QAC7B;QACAsB,YAAYR,CAAAA,SAAUjB,SAAS0B,GAAG,CAACT;QACnCC,gBAAgB,CAACR,OAAOoB,UAAY;YAClC,MAAMC,mBAAmBD,QAAQE,KAAK,CAACf,CAAAA,SAAUjB,SAAS0B,GAAG,CAACT;YAC9D,MAAMN,oBAAoB,IAAIR,IAAIH;YAClC,IAAI+B,kBAAkB;gBACpBpB,kBAAkBsB,KAAK;YACzB,OAAO;gBACLH,QAAQI,OAAO,CAACjB,CAAAA,SAAUN,kBAAkBkB,GAAG,CAACZ;YAClD,CAAC;YACDR,gBAAgBC,OAAOC;QACzB;IACF;IACA,OAAO;QAACX;QAAUc;KAAQ;AAC5B;AAEA,OAAO,SAASqB,aAAapC,MAA2B,EAAE;IACxD,IAAIA,OAAOqC,aAAa,KAAK,eAAe;QAC1C,0EAA0E;QAC1E,sDAAsD;QACtD,OAAOT,qBAAqB5B;IAC9B,CAAC;IACD,0EAA0E;IAC1E,sDAAsD;IACtD,OAAOc,mBAAmBd;AAC5B,CAAC"}