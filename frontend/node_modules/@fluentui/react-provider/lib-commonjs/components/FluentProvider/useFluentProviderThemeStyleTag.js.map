{"version":3,"sources":["useFluentProviderThemeStyleTag.js"],"sourcesContent":["import { useId, useIsomorphicLayoutEffect } from '@fluentui/react-utilities';\nimport * as React from 'react';\nimport { fluentProviderClassNames } from './useFluentProviderStyles.styles';\n// String concatenation is used to prevent bundlers to complain with older versions of React\nconst useInsertionEffect = React['useInsertion' + 'Effect'] ? React['useInsertion' + 'Effect'] : useIsomorphicLayoutEffect;\nconst createStyleTag = (target, elementAttributes)=>{\n    if (!target) {\n        return undefined;\n    }\n    const tag = target.createElement('style');\n    Object.keys(elementAttributes).forEach((attrName)=>{\n        tag.setAttribute(attrName, elementAttributes[attrName]);\n    });\n    target.head.appendChild(tag);\n    return tag;\n};\nconst insertSheet = (tag, rule)=>{\n    const sheet = tag.sheet;\n    if (sheet) {\n        if (sheet.cssRules.length > 0) {\n            sheet.deleteRule(0);\n        }\n        sheet.insertRule(rule, 0);\n    } else if (process.env.NODE_ENV !== 'production') {\n        // eslint-disable-next-line no-console\n        console.error('FluentProvider: No sheet available on styleTag, styles will not be inserted into DOM.');\n    }\n};\n/**\n * Writes a theme as css variables in a style tag on the provided targetDocument as a rule applied to a CSS class\n * @internal\n * @returns CSS class to apply the rule\n */ export const useFluentProviderThemeStyleTag = (options)=>{\n    const { targetDocument , theme , rendererAttributes  } = options;\n    const styleTag = React.useRef();\n    const styleTagId = useId(fluentProviderClassNames.root);\n    const styleElementAttributes = rendererAttributes;\n    const cssVarsAsString = React.useMemo(()=>{\n        return theme ? Object.keys(theme).reduce((cssVarRule, cssVar)=>{\n            cssVarRule += `--${cssVar}: ${theme[cssVar]}; `;\n            return cssVarRule;\n        }, '') : '';\n    }, [\n        theme\n    ]);\n    const rule = `.${styleTagId} { ${cssVarsAsString} }`;\n    useHandleSSRStyleElements(targetDocument, styleTagId);\n    useInsertionEffect(()=>{\n        // The style element could already have been created during SSR - no need to recreate it\n        const ssrStyleElement = targetDocument === null || targetDocument === void 0 ? void 0 : targetDocument.getElementById(styleTagId);\n        if (ssrStyleElement) {\n            styleTag.current = ssrStyleElement;\n        } else {\n            styleTag.current = createStyleTag(targetDocument, {\n                ...styleElementAttributes,\n                id: styleTagId\n            });\n            if (styleTag.current) {\n                insertSheet(styleTag.current, rule);\n            }\n        }\n        return ()=>{\n            var _styleTag_current;\n            (_styleTag_current = styleTag.current) === null || _styleTag_current === void 0 ? void 0 : _styleTag_current.remove();\n        };\n    }, [\n        styleTagId,\n        targetDocument,\n        rule,\n        styleElementAttributes\n    ]);\n    return {\n        styleTagId,\n        rule\n    };\n};\nfunction useHandleSSRStyleElements(targetDocument, styleTagId) {\n    // Using a state factory so that this logic only runs once per render\n    // Each FluentProvider can create its own style element during SSR as a slot\n    // Moves all theme style elements to document head during render to avoid hydration errors.\n    // Should be strict mode safe since the logic is idempotent.\n    React.useState(()=>{\n        if (!targetDocument) {\n            return;\n        }\n        const themeStyleElement = targetDocument.getElementById(styleTagId);\n        if (themeStyleElement) {\n            targetDocument.head.append(themeStyleElement);\n        }\n    });\n}\n"],"names":["useFluentProviderThemeStyleTag","useInsertionEffect","React","useIsomorphicLayoutEffect","createStyleTag","target","elementAttributes","undefined","tag","createElement","Object","keys","forEach","attrName","setAttribute","head","appendChild","insertSheet","rule","sheet","cssRules","length","deleteRule","insertRule","process","env","NODE_ENV","console","error","options","targetDocument","theme","rendererAttributes","styleTag","useRef","styleTagId","useId","fluentProviderClassNames","root","styleElementAttributes","cssVarsAsString","useMemo","reduce","cssVarRule","cssVar","useHandleSSRStyleElements","ssrStyleElement","getElementById","current","id","_styleTag_current","remove","useState","themeStyleElement","append"],"mappings":"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"}