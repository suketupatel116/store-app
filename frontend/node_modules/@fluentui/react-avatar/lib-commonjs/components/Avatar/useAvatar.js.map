{"version":3,"sources":["useAvatar.js"],"sourcesContent":["import * as React from 'react';\nimport { getNativeElementProps, mergeCallbacks, resolveShorthand, useId } from '@fluentui/react-utilities';\nimport { getInitials } from '../../utils/index';\nimport { PersonRegular } from '@fluentui/react-icons';\nimport { PresenceBadge } from '@fluentui/react-badge';\nimport { useFluent_unstable as useFluent } from '@fluentui/react-shared-contexts';\nimport { useAvatarContext } from '../../contexts/AvatarContext';\nexport const DEFAULT_STRINGS = {\n    active: 'active',\n    inactive: 'inactive'\n};\nexport const useAvatar_unstable = (props, ref)=>{\n    const { dir  } = useFluent();\n    const { shape: contextShape , size: contextSize  } = useAvatarContext();\n    const { name , size =contextSize !== null && contextSize !== void 0 ? contextSize : 32 , shape =contextShape !== null && contextShape !== void 0 ? contextShape : 'circular' , active ='unset' , activeAppearance ='ring' , idForColor  } = props;\n    let { color ='neutral'  } = props;\n    // Resolve 'colorful' to a specific color name\n    if (color === 'colorful') {\n        var _ref;\n        color = avatarColors[getHashCode((_ref = idForColor !== null && idForColor !== void 0 ? idForColor : name) !== null && _ref !== void 0 ? _ref : '') % avatarColors.length];\n    }\n    const baseId = useId('avatar-');\n    const root = getNativeElementProps('span', {\n        role: 'img',\n        id: baseId,\n        // aria-label and/or aria-labelledby are resolved below\n        ...props,\n        ref\n    }, /* excludedPropNames: */ [\n        'name'\n    ]);\n    const [imageHidden, setImageHidden] = React.useState(undefined);\n    let image = resolveShorthand(props.image, {\n        defaultProps: {\n            alt: '',\n            role: 'presentation',\n            'aria-hidden': true,\n            hidden: imageHidden\n        }\n    });\n    // Image shouldn't be rendered if its src is not set\n    if (!(image === null || image === void 0 ? void 0 : image.src)) {\n        image = undefined;\n    }\n    // Hide the image if it fails to load and restore it on a successful load\n    if (image) {\n        image.onError = mergeCallbacks(image.onError, ()=>setImageHidden(true));\n        image.onLoad = mergeCallbacks(image.onLoad, ()=>setImageHidden(undefined));\n    }\n    // Resolve the initials slot, defaulted to getInitials.\n    let initials = resolveShorthand(props.initials, {\n        required: true,\n        defaultProps: {\n            children: getInitials(name, dir === 'rtl', {\n                firstInitialOnly: size <= 16\n            }),\n            id: baseId + '__initials'\n        }\n    });\n    // Don't render the initials slot if it's empty\n    if (!(initials === null || initials === void 0 ? void 0 : initials.children)) {\n        initials = undefined;\n    }\n    // Render the icon slot *only if* there aren't any initials or image to display\n    let icon = undefined;\n    if (!initials && (!image || imageHidden)) {\n        icon = resolveShorthand(props.icon, {\n            required: true,\n            defaultProps: {\n                children: /*#__PURE__*/ React.createElement(PersonRegular, null),\n                'aria-hidden': true\n            }\n        });\n    }\n    const badge = resolveShorthand(props.badge, {\n        defaultProps: {\n            size: getBadgeSize(size),\n            id: baseId + '__badge'\n        }\n    });\n    let activeAriaLabelElement;\n    // Resolve aria-label and/or aria-labelledby if not provided by the user\n    if (!root['aria-label'] && !root['aria-labelledby']) {\n        if (name) {\n            root['aria-label'] = name;\n            // Include the badge in labelledby if it exists\n            if (badge) {\n                root['aria-labelledby'] = root.id + ' ' + badge.id;\n            }\n        } else if (initials) {\n            // root's aria-label should be the name, but fall back to being labelledby the initials if name is missing\n            root['aria-labelledby'] = initials.id + (badge ? ' ' + badge.id : '');\n        }\n        // Add the active state to the aria label\n        if (active === 'active' || active === 'inactive') {\n            const activeText = DEFAULT_STRINGS[active];\n            if (root['aria-labelledby']) {\n                // If using aria-labelledby, render a hidden span and append it to the labelledby\n                const activeId = baseId + '__active';\n                root['aria-labelledby'] += ' ' + activeId;\n                activeAriaLabelElement = /*#__PURE__*/ React.createElement(\"span\", {\n                    hidden: true,\n                    id: activeId\n                }, activeText);\n            } else if (root['aria-label']) {\n                // Otherwise, just append it to the aria-label\n                root['aria-label'] += ' ' + activeText;\n            }\n        }\n    }\n    return {\n        size,\n        shape,\n        active,\n        activeAppearance,\n        activeAriaLabelElement,\n        color,\n        components: {\n            root: 'span',\n            initials: 'span',\n            icon: 'span',\n            image: 'img',\n            badge: PresenceBadge\n        },\n        root,\n        initials,\n        icon,\n        image,\n        badge\n    };\n};\nconst getBadgeSize = (size)=>{\n    if (size >= 96) {\n        return 'extra-large';\n    } else if (size >= 64) {\n        return 'large';\n    } else if (size >= 56) {\n        return 'medium';\n    } else if (size >= 40) {\n        return 'small';\n    } else if (size >= 28) {\n        return 'extra-small';\n    } else {\n        return 'tiny';\n    }\n};\nconst avatarColors = [\n    'dark-red',\n    'cranberry',\n    'red',\n    'pumpkin',\n    'peach',\n    'marigold',\n    'gold',\n    'brass',\n    'brown',\n    'forest',\n    'seafoam',\n    'dark-green',\n    'light-teal',\n    'teal',\n    'steel',\n    'blue',\n    'royal-blue',\n    'cornflower',\n    'navy',\n    'lavender',\n    'purple',\n    'grape',\n    'lilac',\n    'pink',\n    'magenta',\n    'plum',\n    'beige',\n    'mink',\n    'platinum',\n    'anchor'\n];\nconst getHashCode = (str)=>{\n    let hashCode = 0;\n    for(let len = str.length - 1; len >= 0; len--){\n        const ch = str.charCodeAt(len);\n        const shift = len % 8;\n        hashCode ^= (ch << shift) + (ch >> 8 - shift); // eslint-disable-line no-bitwise\n    }\n    return hashCode;\n};\n"],"names":["DEFAULT_STRINGS","useAvatar_unstable","active","inactive","props","ref","dir","useFluent","shape","contextShape","size","contextSize","useAvatarContext","name","activeAppearance","idForColor","color","_ref","avatarColors","getHashCode","length","baseId","useId","root","getNativeElementProps","role","id","imageHidden","setImageHidden","React","useState","undefined","image","resolveShorthand","defaultProps","alt","hidden","src","onError","mergeCallbacks","onLoad","initials","required","children","getInitials","firstInitialOnly","icon","createElement","PersonRegular","badge","getBadgeSize","activeAriaLabelElement","activeText","activeId","components","PresenceBadge","str","hashCode","len","ch","charCodeAt","shift"],"mappings":"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"}