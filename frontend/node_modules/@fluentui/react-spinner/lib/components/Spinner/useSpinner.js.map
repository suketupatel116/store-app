{"version":3,"sources":["useSpinner.tsx"],"sourcesContent":["import * as React from 'react';\nimport { getNativeElementProps, resolveShorthand, useId, useTimeout } from '@fluentui/react-utilities';\nimport type { SpinnerProps, SpinnerState } from './Spinner.types';\nimport { Label } from '@fluentui/react-label';\nimport { DefaultSvg } from './DefaultSvg';\nimport { useSpinnerContext } from '../../contexts/SpinnerContext';\n\n/**\n * Create the state required to render Spinner.\n *\n * The returned state can be modified with hooks such as useSpinnerStyles_unstable,\n * before being passed to renderSpinner_unstable.\n *\n * @param props - props from this instance of Spinner\n * @param ref - reference to root HTMLElement of Spinner\n */\nexport const useSpinner_unstable = (props: SpinnerProps, ref: React.Ref<HTMLElement>): SpinnerState => {\n  // Props\n  const { size: contextSize } = useSpinnerContext();\n  const { appearance = 'primary', labelPosition = 'after', size = contextSize ?? 'medium', delay = 0 } = props;\n  const baseId = useId('spinner');\n\n  const { role = 'progressbar', tabIndex, ...rest } = props;\n  const nativeRoot = getNativeElementProps('div', { ref, role, ...rest }, ['size']);\n\n  const [isVisible, setIsVisible] = React.useState(true);\n\n  const [setDelayTimeout, clearDelayTimeout] = useTimeout();\n\n  React.useEffect(() => {\n    if (delay <= 0) {\n      return;\n    }\n    setIsVisible(false);\n    setDelayTimeout(() => {\n      setIsVisible(true);\n    }, delay);\n\n    return () => {\n      clearDelayTimeout();\n    };\n  }, [setDelayTimeout, clearDelayTimeout, delay]);\n\n  const labelShorthand = resolveShorthand(props.label, {\n    defaultProps: {\n      id: baseId,\n    },\n    required: false,\n  });\n\n  const spinnerShortHand = resolveShorthand(props.spinner, {\n    required: true,\n    defaultProps: {\n      children: <DefaultSvg />,\n      tabIndex,\n    },\n  });\n\n  if (labelShorthand && nativeRoot && !nativeRoot['aria-labelledby']) {\n    nativeRoot['aria-labelledby'] = labelShorthand.id;\n  }\n\n  const state: SpinnerState = {\n    appearance,\n    delay,\n    labelPosition,\n    size,\n    shouldRenderSpinner: isVisible,\n    components: {\n      root: 'div',\n      spinner: 'span',\n      label: Label,\n    },\n    root: nativeRoot,\n    spinner: spinnerShortHand,\n    label: labelShorthand,\n  };\n  return state;\n};\n"],"names":["React","getNativeElementProps","resolveShorthand","useId","useTimeout","Label","DefaultSvg","useSpinnerContext","useSpinner_unstable","props","ref","size","contextSize","appearance","labelPosition","delay","baseId","role","tabIndex","rest","nativeRoot","isVisible","setIsVisible","useState","setDelayTimeout","clearDelayTimeout","useEffect","labelShorthand","label","defaultProps","id","required","spinnerShortHand","spinner","children","state","shouldRenderSpinner","components","root"],"mappings":"AAAA,YAAYA,WAAW,QAAQ;AAC/B,SAASC,qBAAqB,EAAEC,gBAAgB,EAAEC,KAAK,EAAEC,UAAU,QAAQ,4BAA4B;AAEvG,SAASC,KAAK,QAAQ,wBAAwB;AAC9C,SAASC,UAAU,QAAQ,eAAe;AAC1C,SAASC,iBAAiB,QAAQ,gCAAgC;AAElE;;;;;;;;CAQC,GACD,OAAO,MAAMC,sBAAsB,CAACC,OAAqBC,MAA8C;IACrG,QAAQ;IACR,MAAM,EAAEC,MAAMC,YAAW,EAAE,GAAGL;IAC9B,MAAM,EAAEM,YAAa,UAAS,EAAEC,eAAgB,QAAO,EAAEH,MAAOC,wBAAAA,yBAAAA,cAAe,QAAQ,CAAA,EAAEG,OAAQ,EAAC,EAAE,GAAGN;IACvG,MAAMO,SAASb,MAAM;IAErB,MAAM,EAAEc,MAAO,cAAa,EAAEC,SAAQ,EAAE,GAAGC,MAAM,GAAGV;IACpD,MAAMW,aAAanB,sBAAsB,OAAO;QAAES;QAAKO;QAAM,GAAGE,IAAI;IAAC,GAAG;QAAC;KAAO;IAEhF,MAAM,CAACE,WAAWC,aAAa,GAAGtB,MAAMuB,QAAQ,CAAC,IAAI;IAErD,MAAM,CAACC,iBAAiBC,kBAAkB,GAAGrB;IAE7CJ,MAAM0B,SAAS,CAAC,IAAM;QACpB,IAAIX,SAAS,GAAG;YACd;QACF,CAAC;QACDO,aAAa,KAAK;QAClBE,gBAAgB,IAAM;YACpBF,aAAa,IAAI;QACnB,GAAGP;QAEH,OAAO,IAAM;YACXU;QACF;IACF,GAAG;QAACD;QAAiBC;QAAmBV;KAAM;IAE9C,MAAMY,iBAAiBzB,iBAAiBO,MAAMmB,KAAK,EAAE;QACnDC,cAAc;YACZC,IAAId;QACN;QACAe,UAAU,KAAK;IACjB;IAEA,MAAMC,mBAAmB9B,iBAAiBO,MAAMwB,OAAO,EAAE;QACvDF,UAAU,IAAI;QACdF,cAAc;YACZK,wBAAU,oBAAC5B;YACXY;QACF;IACF;IAEA,IAAIS,kBAAkBP,cAAc,CAACA,UAAU,CAAC,kBAAkB,EAAE;QAClEA,UAAU,CAAC,kBAAkB,GAAGO,eAAeG,EAAE;IACnD,CAAC;IAED,MAAMK,QAAsB;QAC1BtB;QACAE;QACAD;QACAH;QACAyB,qBAAqBf;QACrBgB,YAAY;YACVC,MAAM;YACNL,SAAS;YACTL,OAAOvB;QACT;QACAiC,MAAMlB;QACNa,SAASD;QACTJ,OAAOD;IACT;IACA,OAAOQ;AACT,EAAE"}